<?php

$menuArray = array("Master Data" => array("Master Perusahaan" => array(array(array("bengkel/list"), "icon-house_two-large", "Identitas Bengkel"), array(array("karyawan/list"), "icon-users_3-large", "Maintenance Karyawan")), "Suku Cadang" => array(array(array("supplier/list"), "icon-client_account_template-large", "Supplier"), array(array("suku-cadang-saran/list"), "icon-track_changes_edit-large", "Pengajuan Nama Suku Cadang"), array(array("suku-cadang-jaringan/list"), "icon-database_server-large", "Data Stock"), array(array("promo/list"), "icon-emotion_bigsmile-large", "Diskon Promosi"), array(array("gudang/list"), "icon-inbox_download-large", "Gudang"), array(array("rak/list"), "icon-drawer_open-large", "Rak")), "Bengkel" => array(array(array("motor/list"), "icon-smartart_change_color_gallery-large", "Tipe Motor-Warna"), array(array("kpb/list"), "icon-tag_red-large", "KPB"), array(array("jasa/list"), "icon-setting_tools-large", "Jasa Service"), array(array("site/empty"), "icon-diamond-large", "Point Service"), array(array("site/empty"), "icon-page_white_ruby-large", "Item Point Service")), "Konsumen" => array(array(array("konsumen/list"), "icon-house_two-large", "Konsumen"), array(array("konsumen-group/list"), "icon-users_3-large", "Group Konsumen"))), "Suku Cadang" => array("Inventory" => array(array(array("parts-order-suku-cadang/index"), "icon-package_add-large", "Pembelian Order Parts"), array(array("parts-penerimaan-stok-gudang/index"), "icon-page_white_put-large", "Penerimaan Stok Gudang"), array(array("parts-stock-opname/index"), "icon-page_menu-large", "Stok Opname Gudang")), "Transaksi" => array(array(array("parts-pengeluaran-retail/index"), "icon-total_plan_cost-large", "Pengeluaran Retail")), "Retur/Koreksi" => array(array(array("parts-retur-pembelian/index"), "icon-table_row_insert-large", "Penerimaan Stok Gudang"), array(array("parts-retur-penjualan/index"), "icon-table_delete-large", "Pembatalan Nota Konsumen"), array(array("parts-koreksi-nota/index"), "icon-table_edit-large", "Koreksi Nota Konsumen")), "Permintaan" => array(array(array("parts-stok-kosong/index"), "icon-box_front_open-large", "Stok Kosong"))), "Bengkel" => array("Proses Mekanik" => array(array(array("bengkel-absensi-mekanik/index"), "icon-user_ballplayer_black-large", "Absensi Mekanik")), "Transaksi Bengkel" => array(array(array("bengkel-penerimaan-service/index"), "icon-table_row_insert-large", "Penerimaan Service"), array(array("bengkel-nota-jasa/index"), "icon-table_gear-large", "Nota Jasa Bengkel")), "Transaksi Retur / Koreksi" => array(array(array("bengkel-pembatalan-nota/index"), "icon-table_delete-large", "Pembatalan Nota"), array(array("bengkel-koreksi-nota/index"), "icon-table_edit-large", "Koreksi Nota"), array(array("bengkel-koreksi-perintah-kerja/index"), "icon-table_lightning-large", "Koreksi Perintah Kerja")), "Monitoring" => array(array(array("bengkel-historikal-konsumen/index"), "icon-clock_select_remain-large", "Historikal Konsumen"), array(array("konsumen/index"), "icon-users_4-large", "Database Konsumen"))), "Utilitas" => array("Laporan" => array(array(array("laporan/index"), "icon-document_check_compatibility-large", "Laporan"), array(array("laporan-stok-akhir/index"), "icon-document_check_compatibility-large", "Data Stock"), array(array("laporan-mekanik/index"), "icon-document_check_compatibility-large", "Performa Mekanik"), array(array("laporan-pendapatan-gabungan/index"), "icon-document_check_compatibility-large", "Pendapatan (Gabungan)"), array(array("laporan-rekap-kpb/index"), "icon-document_check_compatibility-large", "Rekap KPB"), array(array("laporan-karyawan/index"), "icon-document_check_compatibility-large", "Absensi")), "Import" => array(array(array("import/index"), "icon-excel_imports-large", "Import Data")), "Tool" => array(array(array("suku-cadang-adjust/index"), "icon-canvas_size-large", "Adjust Harga Jual")), "Update" => array(array(array("migration/index"), "icon-download_cloud-large", "Unduh Pembaruan"))), "Seminar" => array("Seminar" => array(array(array("seminar-jadwal/index"), "icon-calendar-large", "Jadwal Seminar"), array(array("seminar-modul/index"), "icon-books_infront-large", "Modul Belajar Interaktif"), array(array("seminar-konsultasi/index"), "icon-meeting_workspace-large", "Konsultasi"))), "Keuangan" => array("Laporan" => array(array(array("site/empty"), "icon-document_check_compatibility-large", "Lap Kas"), array(array("site/empty"), "icon-document_check_compatibility-large", "Lap Biaya"), array(array("site/empty"), "icon-document_check_compatibility-large", "Lap Pemasukan"), array(array("site/empty"), "icon-document_check_compatibility-large", "Lap Hutang"), array(array("site/empty"), "icon-document_check_compatibility-large", "Lap Piutang"), array(array("site/empty"), "icon-document_check_compatibility-large", "Lap Laba Rugi"))), "CRM" => array("Customer Relationship Management" => array(array(array("site/empty"), "icon-sound-large", "Promosi"), array(array("site/empty"), "icon-statistics-large", "Demografi"), array(array("site/empty"), "icon-catalog_pages-large", "Katalog"), array(array("site/empty"), "icon-chart_line-large", "Statistik"))), "Part Online" => array("Pesanan" => array(array(array("plaza-pesanan/index"), "icon-user_ballplayer_black-large", "Order Sparepart"))), "User" => array("Member" => array(array(array("site/logout"), "icon-cross-large", "Keluar", true))));
echo "    <div class=\"easyui-ribbon\" id=\"ribbon-menu\">\n        ";
foreach ($menuArray as $titleKey => $titleValue) {
    echo "<div title=\"" . $titleKey . "\">";
    foreach ($titleValue as $groupKey => $groupValue) {
        echo "<div class=\"ribbon-group\"><div class=\"ribbon-toolbar\">";
        foreach ($groupValue as $key => $value) {
            if (count($value) == 4) {
                echo yii\helpers\Html::a($value[2], yii\helpers\Url::to($value[0]), array("url" => yii\helpers\Url::to($value[0]), "class" => "no-ajax easyui-menubutton", "data-options" => "name:'" . $value[2] . "',iconCls:'" . $value[1] . "',iconAlign:'top',size:'large',plain:true"));
            } else {
                echo yii\helpers\Html::a($value[2], "#" . yii\helpers\Url::to($value[0]), array("url" => yii\helpers\Url::to($value[0]), "class" => "link-ajax easyui-menubutton", "data-options" => "name:'" . $value[2] . "',iconCls:'" . $value[1] . "',iconAlign:'top',size:'large',plain:true"));
            }
        }
        echo "</div>";
        echo "<div class=\"ribbon-group-title\">" . $groupKey . "</div>";
        echo "</div><div class=\"ribbon-group-sep\"></div>";
    }
    echo "</div>";
}
echo "    </div>\n\n    <div id=\"output\"></div>\n\n\n\n    <div id=\"dialog\" style=\"padding: 10px 20px;\"></div>\n\n";
$expiredStatus = Yii::$app->cache->get("EXPIRED");
if ($expiredStatus == true) {
    echo "\n    <div id=\"expired_status\">\n        <div id=\"detail\">\n            Mohon selesaikan pembayaran secara online terlebih dahulu.\n            <br>\n        " . yii\helpers\Html::a("Klik jika Sudah Membayar", array("site/index"), array("class" => "easyui-linkbutton")) . "\n        </div>\n    </div>";
}
$moreThan24Hour = false;
$lastOnline = Yii::$app->cache->get("LAST_ONLINE");
$delta = strtotime(date("Y-m-d H:i:s")) - strtotime($lastOnline);
app\components\NodeLogger::sendLog($delta);
if (24 * 3600 < $delta) {
    echo "\n    <div id=\"expired_status\">\n        <div id=\"detail\">\n            E-SIAP belum terkoneksi dengan internet selama lebih dari 24 jam.\n            <br>\n        " . yii\helpers\Html::a("Klik jika merasa Sudah Terkoneksi", array("site/index"), array("class" => "easyui-linkbutton")) . "\n        </div>\n    </div>";
    $moreThan24Hour = true;
}
echo "\n    <div id=\"sync_info\">Sync OK</div>\n\n    <script>\n        function dialog(konten) {\n            //\$(\"#dialog\").html(konten);\n            //\$(\"#dialog\").window(\"open\");\n            \$.messager.alert('Informasi', konten);\n        }\n\n        function loadUrl(url) {\n            \$(\"#output\").html(\"<div id=\\\"loading\\\">\");\n            if (url.indexOf(\"#\") >= 0) {\n                var spl = url.split(\"#\");\n                var processedUrl = spl[1];\n                if (processedUrl == \"#\") {\n                    alert(\"Please Refresh Page\");\n                    return;\n                }\n                \$(\"#output\").load(processedUrl, function () {\n                    \$.parser.parse(\"#output\");\n                });\n                window.location.hash = \"#\" + processedUrl;\n            } else {\n                \$(\"#output\").html(\"\");\n            }\n        }\n\n        function setTitle(title) {\n            \$(\"title\").text(title + \" - E-SIAP\");\n        }\n\n\n        var syncUrl = \"";
echo yii\helpers\Url::to(array("sync/automatic"));
echo "\";\n    </script>\n\n";
$this->registerJs("\n\n\$(document).ready(function(){\n    \$(\".tabs-panels\").attr(\"id\", \"header-tabs\");\n});\n\n\$(\".link-ajax\").click(function(){\n    var href = \$(this).attr(\"href\");\n    loadUrl(href);\n    \$(\"#tab-overlay\").trigger(\"click\");\n});\n\n\$(\".no-ajax\").click(function(){\n    var href = \$(this).attr(\"href\");\n    window.location = href;\n});\n\nvar overlay;\n\n//\$(\"#ribbon-menu\").mouseover(function(){\n\$(\"#ribbon-menu .tabs\").click(function(){\n    var ini = \$(this);\n    \$(\"#header-tabs\").show();\n    if(overlay == null){\n        \$(\"#header-tabs\").append(\"<div id=\\\"tab-overlay\\\"></div>\");\n        overlay = \$(\"#tab-overlay\");\n        overlay.click(function(){\n            \$(\"#header-tabs\").hide();\n            ini.addClass(\"rounded-tabs\");\n        });\n    }else{\n        overlay.show();\n    }\n    ini.removeClass(\"rounded-tabs\");\n}).mouseleave(function(event){\n    //\$(\".tabs-panels\").hide();\n   \n}).addClass(\"rounded-tabs\");\n\n\$(\"#output\").height(\$(window).height()-31);\n\n\$(\"#dialog\").window({\n    width:400,\n    height:300,\n    modal:true,\n    closed:true,\n    title: \"Informasi\"\n});\n\nloadUrl(window.location.href);\n\$(\".tabs-panels\").hide();\n\n");
$expiredStatus = Yii::$app->cache->get("EXPIRED");
if ($expiredStatus == true || $moreThan24Hour) {
    $this->registerJs("\$(\"#expired_status\").height(\$(window).height()); \$(\"#output\").remove();\$(\"#ribbon-menu\").remove();");
} 

?>